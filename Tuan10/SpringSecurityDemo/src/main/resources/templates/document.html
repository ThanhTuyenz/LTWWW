<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="~{layout/menu :: layout(~{::content})}">
<body>
<div th:fragment="content">
    <h2>Document</h2>

    <p th:text="${message}" style="font-style: italic; color: #555;">You have permission to view the document.</p>

    <form th:action="@{/documents/create}" method="post" sec:authorize="hasAuthority('DOCUMENT:WRITE')">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <button type="submit">Create Document (only ADMIN)</button>
    </form>

    <a th:href="@{/admin}" sec:authorize="hasRole('ADMIN')">Admin</a>

    <div sec:authorize="isAuthenticated()" style="margin-top: 20px;">
        <p>Hello <b sec:authentication="name"></b>!</p>
        <p>Authorities: <span sec:authentication="authorities"></span></p>
    </div>
</div>
</body>
</html>
